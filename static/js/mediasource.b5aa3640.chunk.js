"use strict";(self.webpackChunkdemo=self.webpackChunkdemo||[]).push([[756],{689:function(e,t,n){n.r(t),n.d(t,{default:function(){return oe}});var i=n(762),r=n(165),a=n(982),s=n(671),c=n(144),o=n(352),h="webm",u="mp3",l="mp4a.40.2",g="flac",d="vorbis",f="opus",p="audio/",m=";codecs=",_=p+"mp4"+m,y=p+h+m,w="mse-audio-wrapper",v=function(){function e(t){var n=t.name,i=t.contents,r=void 0===i?[]:i,a=t.children,c=void 0===a?[]:a;(0,s.Z)(this,e),this._name=n,this._contents=r,this._children=c}return(0,c.Z)(e,[{key:"contents",get:function(){var t,n=new Uint8Array(this.length),r=this._buildContents(),a=0,s=(0,i.Z)(e.flatten(r));try{for(s.s();!(t=s.n()).done;){var c=t.value;"object"!==typeof c?(n[a]=c,a++):(n.set(c,a),a+=c.length)}}catch(o){s.e(o)}finally{s.f()}return n}},{key:"length",get:function(){return this._buildLength()}},{key:"_buildContents",value:function(){return[this._contents].concat((0,a.Z)(this._children.map((function(e){return e._buildContents()}))))}},{key:"_buildLength",value:function(){return(Array.isArray(this._contents)?this._contents.reduce((function(e,t){return e+(void 0===t.length?1:t.length)}),0):void 0===this._contents.length?1:this._contents.length)+this._children.reduce((function(e,t){return e+t.length}),0)}},{key:"addChild",value:function(e){this._children.push(e)}}],[{key:"stringToByteArray",value:function(e){return(0,a.Z)(e).map((function(e){return e.charCodeAt(0)}))}},{key:"getFloat64",value:function(e){var t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e),t}},{key:"getUint64",value:function(e){var t=new Uint8Array(8);return new DataView(t.buffer).setBigUint64(0,BigInt(e)),t}},{key:"getUint32",value:function(e){var t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e),t}},{key:"getUint16",value:function(e){var t=new Uint8Array(2);return new DataView(t.buffer).setUint16(0,e),t}},{key:"getInt16",value:function(e){var t=new Uint8Array(2);return new DataView(t.buffer).setInt16(0,e),t}},{key:"flatten",value:(0,r.Z)().mark((function t(n){var a,s,c;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=(0,i.Z)(n),t.prev=1,a.s();case 3:if((s=a.n()).done){t.next=13;break}if(c=s.value,!Array.isArray(c)){t.next=9;break}return t.delegateYield(e.flatten(c),"t0",7);case 7:t.next=11;break;case 9:return t.next=11,c;case 11:t.next=3;break;case 13:t.next=18;break;case 15:t.prev=15,t.t1=t.catch(1),a.e(t.t1);case 18:return t.prev=18,a.f(),t.finish(18);case 21:case"end":return t.stop()}}),t,null,[[1,15,18,21]])}))}]),e}(),k=n(752),b=n(120),Z=n(136),S=n(277),U=function(e){(0,Z.Z)(n,e);var t=(0,S.Z)(n);function n(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.contents,a=i.children;return(0,s.Z)(this,n),t.call(this,{name:e,contents:r,children:a})}return(0,c.Z)(n,[{key:"_buildContents",value:function(){return[].concat((0,a.Z)(this._lengthBytes),(0,a.Z)(v.stringToByteArray(this._name)),(0,a.Z)((0,k.Z)((0,b.Z)(n.prototype),"_buildContents",this).call(this)))}},{key:"_buildLength",value:function(){return this._length||(this._length=4+this._name.length+(0,k.Z)((0,b.Z)(n.prototype),"_buildLength",this).call(this),this._lengthBytes=v.getUint32(this._length)),this._length}}]),n}(v),M=function(e){(0,Z.Z)(n,e);var t=(0,S.Z)(n);function n(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.contents,a=i.tags;return(0,s.Z)(this,n),t.call(this,{name:e,contents:r,children:a})}return(0,c.Z)(n,[{key:"_buildContents",value:function(){return[this._name].concat((0,a.Z)(this._lengthBytes),(0,a.Z)((0,k.Z)((0,b.Z)(n.prototype),"_buildContents",this).call(this)))}},{key:"_buildLength",value:function(){if(!this._length){var e=(0,k.Z)((0,b.Z)(n.prototype),"_buildLength",this).call(this);this._lengthBytes=n.getLength(e),this._length=1+e+this._lengthBytes.length}return this._length}},{key:"addTag",value:function(e){this.addChild(e)}}],[{key:"getLength",value:function(e){var t=v.getUint32(e);return t.every((function(e,t,n){return 0===e&&(n[t]=128,!0)})),t}}]),n}(v),A=function(){function e(t){(0,s.Z)(this,e),this._codec=t}return(0,c.Z)(e,[{key:"getCodecBox",value:function(e){switch(this._codec){case u:return this.getMp4a(e,107);case l:return this.getMp4a(e,64);case f:return this.getOpus(e);case g:return this.getFlaC(e)}}},{key:"getOpus",value:function(e){return new U("Opus",{contents:[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channels,0,e.bitDepth,0,0,0,0,U.getUint16(e.sampleRate),0,0],children:[new U("dOps",{contents:[0,e.channels,U.getUint16(e.preSkip),U.getUint32(e.inputSampleRate),U.getInt16(e.outputGain),e.channelMappingFamily,0!==e.channelMappingFamily?[e.streamCount,e.coupledStreamCount,e.channelMappingTable]:[]]})]})}},{key:"getFlaC",value:function(e){return new U("fLaC",{contents:[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channels,0,e.bitDepth,0,0,0,0,U.getUint16(e.sampleRate),0,0],children:[new U("dfLa",{contents:[0,0,0,0].concat((0,a.Z)(e.streamInfo||[128,0,0,34,U.getUint16(e.blockSize),U.getUint16(e.blockSize),0,0,0,0,0,0,U.getUint32(e.sampleRate<<12|e.channels<<8|e.bitDepth-1<<4),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]))})]})}},{key:"getMp4a",value:function(e,t){var n=new M(4,{contents:[t,21,0,0,0,0,0,0,0,0,0,0,0]});return 64===t&&n.addTag(new M(5,{contents:e.audioSpecificConfig})),new U("mp4a",{contents:[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channels,0,16,0,0,0,0,U.getUint16(e.sampleRate),0,0],children:[new U("esds",{contents:[0,0,0,0],children:[new M(3,{contents:[0,1,0],tags:[n,new M(6,{contents:2})]})]})]})}},{key:"getInitializationSegment",value:function(e){var t=e.header,n=e.samples;return new v({children:[new U("ftyp",{contents:[U.stringToByteArray("iso5"),0,0,2,0,U.stringToByteArray("iso6mp41")]}),new U("moov",{children:[new U("mvhd",{contents:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,232,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2]}),new U("trak",{children:[new U("tkhd",{contents:[0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0]}),new U("mdia",{children:[new U("mdhd",{contents:[0,0,0,0,0,0,0,0,0,0,0,0,U.getUint32(t.sampleRate),0,0,0,0,85,196,0,0]}),new U("hdlr",{contents:[0,0,0,0,U.stringToByteArray("mhlr"),U.stringToByteArray("soun"),0,0,0,0,0,0,0,0,0,0,0,0,0]}),new U("minf",{children:[new U("stbl",{children:[new U("stsd",{contents:[0,0,0,0,0,0,0,1],children:[this.getCodecBox(t)]}),new U("stts",{contents:[0,0,0,0,0,0,0,0]}),new U("stsc",{contents:[0,0,0,0,0,0,0,0]}),new U("stsz",{contents:[0,0,0,0,0,0,0,0,0,0,0,0]}),new U("stco",{contents:[0,0,0,0,0,0,0,0]})]})]})]})]}),new U("mvex",{children:[new U("trex",{contents:[0,0,0,0,0,0,0,1,0,0,0,1,U.getUint32(n),0,0,0,0,0,0,0,0]})]})]})]}).contents}},{key:"getSamplesPerFrame",value:function(e){return this._codec===l?e.map((function(e){var t=e.data,n=e.header;return U.getUint32(t.length-n.length)})):e.map((function(e){var t=e.data;return U.getUint32(t.length)}))}},{key:"getFrameData",value:function(e){return this._codec===l?e.map((function(e){var t=e.data,n=e.header;return t.subarray(n.length)})):e.map((function(e){return e.data}))}},{key:"getMediaSegment",value:function(e){return new v({children:[new U("moof",{children:[new U("mfhd",{contents:[0,0,0,0,0,0,0,0]}),new U("traf",{children:[new U("tfhd",{contents:[0,2,0,0,0,0,0,1]}),new U("tfdt",{contents:[0,0,0,0,0,0,0,0]}),new U("trun",{contents:[0,0,2,1,U.getUint32(e.length),U.getUint32(92+4*e.length)].concat((0,a.Z)(this.getSamplesPerFrame(e)))})]})]}),new U("mdat",{contents:this.getFrameData(e)})]}).contents}}]),e}(),T=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.flatMap((function(e){for(var t=[],n=e.length;n>=0;n-=255)t.push(n>=255?255:n);return t}))},C=function(e){(0,Z.Z)(n,e);var t=(0,S.Z)(n);function n(e){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.contents,c=r.children,o=r.isUnknownLength,h=void 0!==o&&o;return(0,s.Z)(this,n),(i=t.call(this,{name:e,contents:a,children:c}))._isUnknownLength=h,i}return(0,c.Z)(n,[{key:"_buildContents",value:function(){return[].concat((0,a.Z)(this._name),(0,a.Z)(this._lengthBytes),(0,a.Z)((0,k.Z)((0,b.Z)(n.prototype),"_buildContents",this).call(this)))}},{key:"_buildLength",value:function(){return this._length||(this._contentLength=(0,k.Z)((0,b.Z)(n.prototype),"_buildLength",this).call(this),this._lengthBytes=this._isUnknownLength?[1,255,255,255,255,255,255,255]:n.getUintVariable(this._contentLength),this._length=this._name.length+this._lengthBytes.length+this._contentLength),this._length}}],[{key:"getUintVariable",value:function(e){var t;if(e<127)t=[128|e];else if(e<16383)(t=v.getUint16(e))[0]|=64;else if(e<2097151)(t=v.getUint32(e).subarray(1))[0]|=32;else if(e<268435455)(t=v.getUint32(e))[0]|=16;else if(e<34359738367)(t=v.getUint64(e).subarray(3))[0]|=8;else if(e<4398046511103)(t=v.getUint64(e).subarray(2))[0]|=4;else if(e<562949953421311)(t=v.getUint64(e).subarray(1))[0]|=2;else if(e<72057594037927940)(t=v.getUint64(e))[0]|=1;else if("number"!==typeof e||isNaN(e))throw function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.error(w,t.reduce((function(e,t){return e+"\n  "+t}),""))}("EBML Variable integer must be a number, instead received ".concat(e)),new Error(w+": Unable to encode WEBM");return t}}]),n}(v),E=[225],F=[98,100],L=[159],R=[31,67,182,117],B=[86,170],x=[134],I=[99,162],P=[66,130],N=[66,133],D=[66,135],V=[26,69,223,163],O=[66,242],G=[66,243],z=[66,247],X=[66,134],Y=[156],H=[21,73,169,102],j=[77,128],W=[181],q=[86,187],J=[24,83,128,103],K=[163],Q=[231],$=[42,215,177],ee=[174],te=[215],ne=[22,84,174,107],ie=[131],re=[115,197],ae=[87,65],se=function(){function e(t){var n=this;switch((0,s.Z)(this,e),t){case f:this._codecId="A_OPUS",this._getCodecSpecificTrack=function(e){return[new C(B,{contents:C.getUint32(Math.round(e.preSkip*n._timestampScale))}),new C(q,{contents:C.getUint32(Math.round(3840*n._timestampScale))}),new C(I,{contents:e.data})]};break;case d:this._codecId="A_VORBIS",this._getCodecSpecificTrack=function(e){return[new C(I,{contents:[2,T(e.data,e.vorbisComments),e.data,e.vorbisComments,e.vorbisSetup]})]}}}return(0,c.Z)(e,[{key:"getInitializationSegment",value:function(e){var t=e.header;return this._timestampScale=1e9/t.sampleRate,new v({children:[new C(V,{children:[new C(X,{contents:1}),new C(z,{contents:1}),new C(O,{contents:4}),new C(G,{contents:8}),new C(P,{contents:C.stringToByteArray(h)}),new C(D,{contents:4}),new C(N,{contents:2})]}),new C(J,{isUnknownLength:!0,children:[new C(H,{children:[new C($,{contents:C.getUint32(Math.floor(this._timestampScale))}),new C(j,{contents:C.stringToByteArray(w)}),new C(ae,{contents:C.stringToByteArray(w)})]}),new C(ne,{children:[new C(ee,{children:[new C(te,{contents:1}),new C(re,{contents:1}),new C(Y,{contents:0}),new C(x,{contents:C.stringToByteArray(this._codecId)}),new C(ie,{contents:2}),new C(E,{children:[new C(L,{contents:t.channels}),new C(W,{contents:C.getFloat64(t.sampleRate)}),new C(F,{contents:t.bitDepth})]})].concat((0,a.Z)(this._getCodecSpecificTrack(t)))})]})]})]}).contents}},{key:"getMediaSegment",value:function(e){var t=e[0].totalSamples;return new C(R,{children:[new C(Q,{contents:C.getUintVariable(t)})].concat((0,a.Z)(e.map((function(e){var n=e.data,i=e.totalSamples;return new C(K,{contents:[129,C.getInt16(i-t),128,n]})}))))}).contents}}]),e}(),ce=function(){},oe=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,s.Z)(this,e),this._inputMimeType=t,this.PREFERRED_CONTAINER=i.preferredContainer||h,this.MIN_FRAMES=i.minFramesPerSegment||4,this.MAX_FRAMES=i.maxFramesPerSegment||50,this.MIN_FRAMES_LENGTH=i.minBytesPerSegment||1022,this.MAX_SAMPLES_PER_SEGMENT=1/0,this._onMimeType=i.onMimeType||ce,i.codec&&(this._container=this._getContainer(i.codec),this._onMimeType(this._mimeType)),this._frames=[],this._codecParser=new o.ZP(t,{onCodec:function(e){n._container=n._getContainer(e),n._onMimeType(n._mimeType)},onCodecUpdate:i.onCodecUpdate,enableLogging:i.enableLogging,enableFrameCRC32:!1})}return(0,c.Z)(e,[{key:"mimeType",get:function(){return this._mimeType}},{key:"inputMimeType",get:function(){return this._inputMimeType}},{key:"iterator",value:(0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.constructor!==Uint8Array){e.next=4;break}return e.delegateYield(this._processFrames((0,a.Z)(this._codecParser.parseChunk(t)).flatMap((function(e){return e.codecFrames||e}))),"t0",2);case 2:e.next=6;break;case 4:if(!Array.isArray(t)){e.next=6;break}return e.delegateYield(this._processFrames(t),"t1",6);case 6:case"end":return e.stop()}}),e,this)}))},{key:"_processFrames",value:(0,r.Z)().mark((function e(t){var n,s,c,o,h;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=this._frames).push.apply(n,(0,a.Z)(t)),!this._frames.length){e.next=25;break}if(!(s=this._groupFrames()).length){e.next=25;break}if(this._sentInitialSegment){e.next=8;break}return this._sentInitialSegment=!0,e.next=8,this._container.getInitializationSegment(s[0][0]);case 8:c=(0,i.Z)(s),e.prev=9,c.s();case 11:if((o=c.n()).done){e.next=17;break}return h=o.value,e.next=15,this._container.getMediaSegment(h);case 15:e.next=11;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(9),c.e(e.t0);case 22:return e.prev=22,c.f(),e.finish(22);case 25:case"end":return e.stop()}}),e,this,[[9,19,22,25]])}))},{key:"_groupFrames",value:function(){var e,t=[[]],n=t[0],r=0,a=(0,i.Z)(this._frames);try{for(a.s();!(e=a.n()).done;){var s=e.value;(n.length===this.MAX_FRAMES||r>=this.MAX_SAMPLES_PER_SEGMENT)&&(r=0,t.push(n=[])),n.push(s),r+=s.samples}}catch(c){a.e(c)}finally{a.f()}return this._frames=n.length<this.MIN_FRAMES||n.reduce((function(e,t){return e+t.data.length}),0)<this.MIN_FRAMES_LENGTH?t.pop():[],t}},{key:"_getContainer",value:function(e){switch(e){case"mpeg":return this._mimeType="".concat(_,'"').concat(u,'"'),new A(u);case"aac":return this._mimeType="".concat(_,'"').concat(l),new A(l);case"flac":return this._mimeType="".concat(_,'"').concat(g,'"'),new A(g);case"vorbis":return this._mimeType="".concat(y,'"').concat(d,'"'),this.MAX_SAMPLES_PER_SEGMENT=32767,new se(d);case"opus":return this.PREFERRED_CONTAINER===h?(this._mimeType="".concat(y,'"').concat(f,'"'),this.MAX_SAMPLES_PER_SEGMENT=32767,new se(f)):(this._mimeType="".concat(_,'"').concat(f,'"'),new A(f))}}}]),e}()}}]);
//# sourceMappingURL=mediasource.b5aa3640.chunk.js.map